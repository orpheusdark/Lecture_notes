# Question No: 5  

## Problem Statement  

Leka is working as an intern at a vacation rental company.  
Her task is to manage and analyze rental and booking data.  

The database admin has already created two tables:  

- **Table Name:** `Rentals`  
  ![Rentals Table](https://github.com/user-attachments/assets/758b3173-3c02-4993-b8e2-676add991553)  

- **Table Name:** `Bookings`  
  ![Bookings Table](https://github.com/user-attachments/assets/4c57407e-870f-4213-9e83-dc90b3a96fe6)  

**Sample Input Records:**  

![Sample Input](https://github.com/user-attachments/assets/03c4c002-b70a-4049-a9bf-37e01f8af777)  

---

## Tasks for Leka  

1. **Insert Records**: Insert at least 5 records into the `Rentals` and `Bookings` tables with the values mentioned.  
2. **Update Prices**: Apply a **20% discount** to rentals located in `'Forest'` or `'Mountain'` with a price greater than **$120**.  
3. **Delete Bookings**: Delete bookings made before `'2024-02-01'` where the customer ID is less than **203**.  
4. **Select Rentals**: Retrieve rentals that are available in **July or August 2024** and priced under **$100**.  

---

## Answer  

```sql
-- Insert records into Rentals
INSERT INTO Rentals (RentalID, Location, PricePerNight, AvailableFrom, AvailableTo)
VALUES (1, 'Beach', 120.00, TO_DATE('2024-07-25', 'YYYY-MM-DD'), TO_DATE('2024-09-10', 'YYYY-MM-DD'));

INSERT INTO Rentals (RentalID, Location, PricePerNight, AvailableFrom, AvailableTo)
VALUES (2, 'Mountain', 250.00, TO_DATE('2024-08-01', 'YYYY-MM-DD'), TO_DATE('2024-10-01', 'YYYY-MM-DD'));

INSERT INTO Rentals (RentalID, Location, PricePerNight, AvailableFrom, AvailableTo)
VALUES (3, 'City', 90.00, TO_DATE('2024-07-20', 'YYYY-MM-DD'), TO_DATE('2024-08-30', 'YYYY-MM-DD'));

INSERT INTO Rentals (RentalID, Location, PricePerNight, AvailableFrom, AvailableTo)
VALUES (4, 'Beach', 80.00, TO_DATE('2024-07-28', 'YYYY-MM-DD'), TO_DATE('2024-09-15', 'YYYY-MM-DD'));

INSERT INTO Rentals (RentalID, Location, PricePerNight, AvailableFrom, AvailableTo)
VALUES (5, 'Forest', 150.00, TO_DATE('2024-07-22', 'YYYY-MM-DD'), TO_DATE('2024-09-20', 'YYYY-MM-DD'));


-- Insert records into Bookings
INSERT INTO Bookings (BookingID, RentalID, CustomerID, BookingDate)
VALUES (1, 1, 201, TO_DATE('2024-07-01', 'YYYY-MM-DD'));

INSERT INTO Bookings (BookingID, RentalID, CustomerID, BookingDate)
VALUES (2, 2, 202, TO_DATE('2023-12-15', 'YYYY-MM-DD'));

INSERT INTO Bookings (BookingID, RentalID, CustomerID, BookingDate)
VALUES (3, 3, 203, TO_DATE('2024-01-10', 'YYYY-MM-DD'));

INSERT INTO Bookings (BookingID, RentalID, CustomerID, BookingDate)
VALUES (4, 4, 204, TO_DATE('2023-11-20', 'YYYY-MM-DD'));

INSERT INTO Bookings (BookingID, RentalID, CustomerID, BookingDate)
VALUES (5, 5, 205, TO_DATE('2024-07-15', 'YYYY-MM-DD'));


-- Update Prices: Apply 20% discount
UPDATE Rentals
SET PricePerNight = PricePerNight * 0.8
WHERE Location IN ('Forest', 'Mountain') AND PricePerNight > 120;


-- Delete Bookings before 2024-02-01 with CustomerID < 203
DELETE FROM Bookings
WHERE BookingDate < TO_DATE('2024-02-01', 'YYYY-MM-DD')
  AND CustomerID < 203;


-- Select Rentals: Available in July or August 2024 and priced < $100
SELECT *
FROM Rentals
WHERE PricePerNight < 100
  AND AvailableFrom <= TO_DATE('2024-08-31', 'YYYY-MM-DD')
  AND AvailableTo >= TO_DATE('2024-07-01', 'YYYY-MM-DD');
