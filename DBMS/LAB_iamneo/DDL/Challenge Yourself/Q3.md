# Question No: 3  


## Problem Statement  

Samantha is a data analyst at a fitness center. She needs to manage **exercise** and **user** data.  
The database admin has created two tables: **Exercises** and **Users**. Samantha needs to perform operations on these tables based on certain conditions.

<img width="130" height="85" alt="8212993954-1" src="https://github.com/user-attachments/assets/cd095828-b714-4186-bc51-1127194c1e7f" /> 
<img width="121" height="65" alt="8212993954-2" src="https://github.com/user-attachments/assets/c520e3ec-dc99-46aa-a3d0-c3ea1eff09fa" /> 
<img width="376" height="190" alt="3412312442-1" src="https://github.com/user-attachments/assets/3da9fe3b-520d-44f5-b2ce-0662b8b0ef08" /> 
<img width="289" height="180" alt="3412312442-2" src="https://github.com/user-attachments/assets/f89c110c-d601-4f00-9a92-c378c4d62e3c" />

---

## Tasks  

1. Insert the given records into the **Exercises** and **Users** tables.  
2. Update `CaloriesBurned` for exercises where:
   - `ExerciseDate` is between '2024-07-08' and '2024-07-15'
   - `CaloriesBurned` < 300
   - `ExerciseType` is not 'Yoga'  
   Add 100 to the `CaloriesBurned` value.
3. Delete exercises where:
   - `ExerciseDate` is older than '2023-07-01' **AND** `CaloriesBurned` > 500  
   **OR** `ExerciseType` = 'Cardio'
4. Select exercises where:
   - `ExerciseDate` is within the last 30 days (from '2024-07-15')  
   - `CaloriesBurned` > 200  
   - `ExerciseType` is not 'Strength Training'
5. Select users with `UserID` 1101 or 1102.

---

## SQL Answer  

```sql
-- Insert records into the Exercises table
INSERT INTO Exercises (ExerciseID, ExerciseType, CaloriesBurned, ExerciseDate) 
VALUES (4, 'Cardio', 600, DATE '2023-06-30');

INSERT INTO Exercises (ExerciseID, ExerciseType, CaloriesBurned, ExerciseDate) 
VALUES (5, 'Strength Training', 350, DATE '2024-07-14');

INSERT INTO Exercises (ExerciseID, ExerciseType, CaloriesBurned, ExerciseDate) 
VALUES (6, 'Walking', 250, DATE '2024-07-10');

INSERT INTO Exercises (ExerciseID, ExerciseType, CaloriesBurned, ExerciseDate) 
VALUES (7, 'Swimming', 280, DATE '2024-07-12');

INSERT INTO Exercises (ExerciseID, ExerciseType, CaloriesBurned, ExerciseDate) 
VALUES (8, 'Cycling', 290, DATE '2024-07-14');

-- Insert records into the Users table
INSERT INTO Users (UserID, UserName, Email) 
VALUES (1101, 'Alice', 'alice@example.com');

INSERT INTO Users (UserID, UserName, Email) 
VALUES (1102, 'Bob', 'bob@example.com');

INSERT INTO Users (UserID, UserName, Email) 
VALUES (1103, 'Charlie', 'charlie@example.com');

INSERT INTO Users (UserID, UserName, Email) 
VALUES (1104, 'David', 'david@example.com');

INSERT INTO Users (UserID, UserName, Email) 
VALUES (1105, 'Eve', 'eve@example.com');

-- Update CaloriesBurned for exercises within last 7 days from '2024-07-15', CaloriesBurned < 300, ExerciseType <> 'Yoga'
UPDATE Exercises
SET CaloriesBurned = CaloriesBurned + 100
WHERE ExerciseDate BETWEEN DATE '2024-07-08' AND DATE '2024-07-15'
  AND CaloriesBurned < 300
  AND ExerciseType <> 'Yoga';

-- Delete exercises where ExerciseDate < '2023-07-01' AND CaloriesBurned > 500 OR ExerciseType = 'Cardio'
DELETE FROM Exercises
WHERE (ExerciseDate < DATE '2023-07-01' AND CaloriesBurned > 500)
   OR ExerciseType = 'Cardio';

-- Select exercises within the last 30 days from '2024-07-15', CaloriesBurned > 200, ExerciseType <> 'Strength Training'
SELECT *
FROM Exercises
WHERE ExerciseDate BETWEEN DATE '2024-06-15' AND DATE '2024-07-15'
  AND CaloriesBurned > 200
  AND ExerciseType <> 'Strength Training';

-- Select specific users by UserID
SELECT *
FROM Users
WHERE UserID IN (1101, 1102);
